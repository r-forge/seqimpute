var_duration[n,i] <- var(duration_values[n,,i])
param_duration[n,i] <- mean(duration_values[n,,i])
}
}
}
return(list(param_duration,var_duration))
}
mspell <- function(seqdata){
spells <- data.frame(dss =factor(as.vector(as.matrix(seqdss(seqdata, with.missing=TRUE)))), dur=as.vector(seqdur(seqdata, with.missing=TRUE)))
sp <- droplevels(subset(spells, !is.na(dur)))
vec <- by(sp$dur, list(sp$dss), FUN=mean)
vec_var <- by(sp$dur, list(sp$dss), FUN=var)
return(list(vec,vec_mar))
}
getNamed <- function(data,allstates){
data <- data[allstates]
return(ifelse(is.na(data), 0, data))
}
duration <- function(seqdata){
nalphabet <- length(alphabet(seqdata))
olength <- ncol(seqdata)
results <- mspell(seqdata)
allstates <- names(results[[1]])
return(list(getNamed(results[[1]],allstates),getNamed(results[[2]],allstates)))
}
chunk <- function(x,n) split(x, factor(sort(rank(x)%%n)))
library("TraMineR")
seqdss(seqdata)
seqdata <- seqdef(mvad[,10:70])
data(mvad)
seqdata <- seqdef(mvad[,10:70])
seqdss(seqdata)
seqdata <- seqdef(mvad[,30:70])
seqdss(seqdata)
seqtrate(seqdss(seqdata))
odd_transitions <- matrix(0,size_alphabet,size_alphabet-2)
size_alphabet <- 6
odd_transitions <- matrix(0,size_alphabet,size_alphabet-2)
for(j in 1:size_alphabet){
count <- 1
for(k in 1:size_alphabet){
if(k!=which_maxseq[j] & k!=j){
odd_transitions[j,count] <- sds_trans[j,k]/sds_trans[j,which_maxseq[j]]
count <- count+1
}
}
}
test <- seqdss(seqdata)
test[c(1:200,14),]
50*100
5000/60
10*50
12*60
10*100
1000/60
7500/60
1500/60
50*15
750/12
750/60
15*25
375/60
15*50
750/60
15*40
15*20
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
data_miss <- list_simdatasets[[12]]
which(is.na(list_simdatasets[[12]][,1]))
data_miss_tmp <- list_simdatasets[[12]][which(is.na(list_simdatasets[[12]][,1])),]
seqiplot(seqdef(data_miss_tmp))
library("TraMineR")
seqiplot(seqdef(data_miss_tmp))
seqiplot(seqdef(data_miss_tmp,right=NA))
seqiplot(seqdef(data_miss_tmp,right=NA))
library("TraMineR")
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
data_miss <- list_simdatasets[[12]]
which(is.na(list_simdatasets[[12]][,1]))
data_miss_tmp <- list_simdatasets[[12]][which(is.na(list_simdatasets[[12]][,1])),]
seqiplot(seqdef(data_miss_tmp,right=NA))
seqiplot(seqdef(seqimp[1:3710,3:28]))
seqiplot(seqdef(seqimp[1:3710,3:28]))
seqiplot(seqdef(seqimp[which(is.na(list_simdatasets[[12]][,1])),3:28]))
?seqtrans
?seqtrate
seqtrate(list_simdatasets[[12]],time.varying = T)
seqtrate(seqdef(list_simdatasets[[12]]),time.varying = T)
seqtrate(seqdef(list_simdatasets[[12]]),time.varying = T)[,,1]
seqIplot(seqdef(seqimp[which(is.na(list_simdatasets[[12]][,1])),3:28]))
tt<-which(is.na(list_simdatasets[[12]][,1]))
seqtrate(seqdef(list_simdatasets[[12]][!tt,]),time.varying = T)[,,1]
!tt
seqtrate(seqdef(list_simdatasets[[12]][-tt,]),time.varying = T)[,,1]
library("seqimpute")
test<-seqimpute(list_simdatasets[[12]],np=1,nf=1,timing=TRUE,timeFrame = 0,m=1)
seqIplot(seqdef(test[which(is.na(list_simdatasets[[12]][,1])),3:28]))
seqIplot(seqdef(test[which(is.na(list_simdatasets[[12]][,1])),]))
?seqimpute
test<-seqimpute(list_simdatasets[[12]],np=1,nf=1,timing=TRUE,timeFrame = 0,m=1,nfi=1)
seqIplot(seqdef(test[which(is.na(list_simdatasets[[12]][,1])),]))
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
length(table(list_simdatasets[[1]][,1]))
two_states <- matrix(NA,nsimdatasets,100)
nsimdatasets <- 100
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(list_simdatasets[[1]][,1]))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states)
sum(two_states,na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(list_simdatasets[[i]][,j]))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states,na.rm=T)
i
j
i<-12
j<-1
table(list_simdatasets[[i]][,j])
table(droplevels(list_simdatasets[[i]][,j]))
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states,na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n1_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n3_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n4_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n5_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n6_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n6_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n5_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n4_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n3_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n1_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n1_small.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_small.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n3_small.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n4_small.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n5_small.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n6_small.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n6_small.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
sum(two_states, na.rm=T)
rowSums(two_states, na.rm=T)
which(rowSums(two_states, na.rm=T)!=0)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
which(rowSums(two_states, na.rm=T)!=0)
rm(list=ls())
load("C:/Users/Kevin/switchdrive/Sim/seqimp_t0_P5F5_n2_m12_MAR.Rdata")
library("TraMineR")
seqIplot(seqdef(seqimp[1:3710,3:28]))
library("TraMineR")
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
data_miss <- list_simdatasets[[12]]
tt<-which(is.na(list_simdatasets[[12]][,1]))
load("C:/Users/Kevin/switchdrive/Sim/seqimp_t0_P5F5_n2_m12_MAR.Rdata")
seqIplot(seqdef(seqimp[tt,3:28]))
?pdf
setwd("C:/Users/Kevin/Documents")
pdf(seqIplot(seqdef(seqimp[tt,3:28])))
dev.off()
pdf(file="test.Rdata")
seqIplot(seqdef(seqimp[tt,3:28]))
dev.off()
pdf(file="test.pdf")
seqIplot(seqdef(seqimp[tt,3:28]))
dev.off()
tt<-which(is.na(list_simdatasets[[12]][,1]))
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1_n2_m12_MAR.Rdata")
seqIplot(seqdef(seqimp[tt,3:28]))
rm(list=ls())
seqIplot(seqdef(seqimp[tt,3:28]))
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1_n2_m13_MAR.Rdata")
library("TraMineR")
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
?seqimpute
library("seqimpute")
test<-seqimpute(list_simdatasets[[12]],np=1,nf=1,timing=TRUE,timeFrame = 0,m=3,ParExec = T)
test<-seqimpute(list_simdatasets[[12]],np=1,nf=1,m=3,ParExec = T)
?seqimpute
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
nsimdatasets <- 100
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
which(rowSums(two_states, na.rm=T)!=0)
library("TraMineR")
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
data_miss <- list_simdatasets[[12]]
tt<-which(is.na(list_simdatasets[[12]][,1]))
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1_n2_m12_MAR.Rdata")
seqIplot(seqdef(seqimp[tt,3:28]))
seqIplot(seqdef(seqimp[tt,3:28]))
dev.off()
seqIplot(seqdef(seqimp[tt,3:28]))
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
which(rowSums(two_states, na.rm=T)!=0)
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
two_states <- matrix(NA,nsimdatasets,100)
for(i in 1:nsimdatasets){
for(j in 1:ncol(list_simdatasets[[i]])){
if(length(table(droplevels(list_simdatasets[[i]][,j])))==2){
two_states[i,j] <- 1
}
}
}
which(rowSums(two_states, na.rm=T)!=0)
?seqimpute
rm(list=ls())
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
library("seqimput")
library("seqimpute")
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
max(rowSums(is.na(list_simdatasets[[15]])))
which(rowSums(is.na(list_simdatasets[[15]]))==max(rowSums(is.na(list_simdatasets[[15]]))))
rowSums(is.na(list_simdatasets[[15]]))
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
list_simdatasets[[15]]
seqIplot(seqdef(list_simdatasets[[15]]),with.missings=T)
?seqIplot
seqIplot(seqdef(list_simdatasets[[15]]),with.missings=T)
seqIplot(seqdef(list_simdatasets[[15]]),with.missings=T)
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
setwd("C:/Users/Kevin/Documents/seqimpute/pkg")
library("devtools")
load_all()
test<-seqimpute(list_simdatasets[[15]],np=1,nf=1,timing=TRUE,timeFrame = 5,m=1,ParExec = T)
library("TraMineR")
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
data_miss <- list_simdatasets[[12]]
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
data_miss <- list_simdatasets[[12]]
tt<-which(is.na(list_simdatasets[[12]][,1]))
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1F1_n2_m12_MAR.Rdata")
seqIplot(seqimp[tt,3:28])
seqIplot(seqdef(seqimp[tt,3:28]))
seqimp[tt,3:28]
tt
library("TraMineR")
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_att.Rdata")
data_miss <- list_simdatasets[[12]]
tt<-which(is.na(list_simdatasets[[12]][,1]))
tt
library("TraMineR")
load("C:/Users/Kevin/switchdrive/Sim/Results_done/seqimpute_multinom_t0_P1F1_MAR/seqimp_t0_P1F1_n2_m12_MAR.Rdata")
load("C:/Users/Kevin/switchdrive/Sim/Datasets/n2_MAR.Rdata")
data_miss <- list_simdatasets[[12]]
tt<-which(is.na(list_simdatasets[[12]][,1]))
tt
load("C:/Users/Kevin/switchdrive/Sim/seqimpP1F1_n2_m12_MAR.Rdata")
seqIplot(seqdef(seqimp[tt,3:28]))
seqIplot(seqdef(seqimp[tt,3:28]))
seqimp[tt,3:28]
dev.off()
seqIplot(seqdef(seqimp[tt,3:28]))
